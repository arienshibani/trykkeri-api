{
  "annotations": {"list": []},
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "description": "Total request count in the selected time range",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "unit": "short"}, "overrides": []},
      "gridPos": {"h": 4, "w": 6, "x": 0, "y": 0},
      "id": 10,
      "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "sum(count_over_time({container=\"trykkeri-api\"} | json [$__range]))", "refId": "A"}],
      "title": "Total requests",
      "type": "stat"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "description": "4xx / 5xx responses in the selected time range",
      "fieldConfig": {"defaults": {"color": {"mode": "thresholds"}, "mappings": [], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}, {"color": "red", "value": 1}]}}, "overrides": []},
      "gridPos": {"h": 4, "w": 6, "x": 6, "y": 0},
      "id": 11,
      "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "sum(count_over_time({container=\"trykkeri-api\"} | json | level=\"ERROR\" [$__range]))", "refId": "A"}],
      "title": "Errors",
      "type": "stat"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "description": "Average response time (ms) from request logs",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "unit": "ms"}, "overrides": []},
      "gridPos": {"h": 4, "w": 6, "x": 12, "y": 0},
      "id": 12,
      "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "avg by () (avg_over_time({container=\"trykkeri-api\"} | json | unwrap duration_ms [$__range]))", "refId": "A"}],
      "title": "Avg response time",
      "type": "stat"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "description": "Requests per minute (rate of log lines)",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "unit": "short"}, "overrides": []},
      "gridPos": {"h": 4, "w": 6, "x": 18, "y": 0},
      "id": 13,
      "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "auto", "reduceOptions": {"calcs": ["lastNotNull"], "fields": "", "values": false}, "textMode": "auto"},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "sum(rate({container=\"trykkeri-api\"}[5m])) * 60", "refId": "A"}],
      "title": "Request rate (req/min)",
      "type": "stat"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "description": "Average response duration (ms) over time from request log middleware",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"drawStyle": "line", "fillOpacity": 10, "lineWidth": 1}, "unit": "ms"}, "overrides": []},
      "gridPos": {"h": 6, "w": 24, "x": 0, "y": 4},
      "id": 20,
      "options": {"legend": {"displayMode": "hidden", "placement": "bottom", "showLegend": false}},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "avg by () (avg_over_time({container=\"trykkeri-api\"} | json | unwrap duration_ms [2m]))", "legendFormat": "Avg duration (ms)", "refId": "A"}],
      "title": "Response time (avg ms)",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "description": "Request rate (log lines per minute) over time",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "custom": {"drawStyle": "line", "fillOpacity": 10, "lineWidth": 1}, "unit": "short"}, "overrides": []},
      "gridPos": {"h": 6, "w": 24, "x": 0, "y": 10},
      "id": 21,
      "options": {"legend": {"displayMode": "list", "placement": "bottom", "showLegend": true}},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "sum(rate({container=\"trykkeri-api\"}[1m])) * 60", "legendFormat": "req/min", "refId": "A"}],
      "title": "Request rate over time (req/min)",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "description": "Request count by HTTP status in the selected time range",
      "fieldConfig": {"defaults": {"color": {"mode": "palette-classic"}, "unit": "short"}, "overrides": []},
      "gridPos": {"h": 6, "w": 24, "x": 0, "y": 16},
      "id": 22,
      "options": {"displayMode": "gradient", "orientation": "horizontal", "showUnfilled": true},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "sum by (status) (count_over_time({container=\"trykkeri-api\"} | json [$__range]))", "legendFormat": "{{status}}", "refId": "A"}],
      "title": "Requests by status",
      "type": "bargauge"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "gridPos": {"h": 8, "w": 24, "x": 0, "y": 22},
      "id": 2,
      "options": {"dedupStrategy": "none", "enableLogDetails": true, "prettifyLogMessage": true, "showCommonLabels": false, "showLabels": true, "showTime": true, "sortOrder": "Descending", "wrapLogMessage": true},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "{container=\"trykkeri-api\"} | json | level=\"ERROR\"", "refId": "A"}],
      "title": "Errors ðŸš¨",
      "type": "logs"
    },
    {
      "datasource": {"type": "loki", "uid": "loki"},
      "gridPos": {"h": 16, "w": 24, "x": 0, "y": 30},
      "id": 1,
      "options": {"dedupStrategy": "none", "enableLogDetails": true, "prettifyLogMessage": true, "showCommonLabels": false, "showLabels": true, "showTime": true, "sortOrder": "Descending", "wrapLogMessage": true},
      "targets": [{"datasource": {"type": "loki", "uid": "loki"}, "expr": "{container=\"trykkeri-api\"}", "refId": "A"}],
      "title": "Logs ðŸªµ",
      "type": "logs"
    }
  ],
  "refresh": "5s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": [],
  "templating": {"list": []},
  "time": {"from": "now-1h", "to": "now"},
  "timepicker": {},
  "timezone": "browser",
  "title": "trykkeri-api logs",
  "uid": "trykkeriapi",
  "version": 3,
  "weekStart": ""
}
